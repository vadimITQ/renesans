
<div class="anti-fraud-details-header">
    <pe-indent [mTop]="4"></pe-indent>
    <pe-back-arrow></pe-back-arrow>
    <pe-indent [mBottom]="3"></pe-indent>
</div>

<div class="anti-fraud-details pe-border" [formGroup]="form" *ngIf="hasAccessToComponent">

    <h5>AntiFraud проверка: просмотр деталей по заявке</h5>

    <div class="paragraph">
        <pe-indent [mTop]="3"></pe-indent>
        Информация по заявке
        <pe-indent [mBottom]="6"></pe-indent>
    </div>

    <div class="info-block">
        <pe-input-form [control]="form.controls.IdPE"               label="ID PE"                [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.paymentDatePE"      label="Дата заявки PE"       [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.fioPayer"           label="ФИО плательщика"      [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.writeOffAccount"    label="Счёт списания"        [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.recipientFio"       label="ФИО получателя/наименования организации" [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.recipientAccount"   label="Счёт получателя"      [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.recipientINN"       label="ИНН получателя"       [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.recipientBankBIK"   label="БИК банка получателя" [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.appointment"        label="Назначение"           [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.transferAmount"     label="Сумма перевода"       [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.ip"                 label="IP-адрес"             [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
        <pe-input-form [control]="form.controls.userAgent"          label="User-agent"           [labelStyle]="labelsStyle" [disabled]="true"></pe-input-form>
    </div>

    <div class="paragraph">
        <pe-indent [mTop]="3"></pe-indent>
        Автоматические проверки
        <pe-indent [mBottom]="4"></pe-indent>
    </div>
    
    <div class="automatic-checks">
        <p-table
            *ngIf="!!detailsData && !!detailsData.antiFraudAutomaticChecks"
            [value]="detailsData.antiFraudAutomaticChecks"
            [scrollable]="true"
            [autoLayout]="true"
            [resizableColumns]="true"
            [showCurrentPageReport]="true"
            [lazy]="true"
            [columnResizeMode]="'expand'"
            styleClass="p-datatable-gridlines p-datatable-sm">
            <ng-template pTemplate="header">
                <tr>
                    <th>
                        Статус автоматических проверок AntiFraud
                    </th>
                    <th>
                        Сработавшие правила автоматических проверок AntiFraud
                    </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-detailsItem>
                <tr>
                    <td>
                        {{detailsItem.status}}
                    </td>
                    <td>
                        {{detailsItem.rules}}
                    </td>
                </tr>
            </ng-template>
        </p-table>
        <pe-loading-spinner *ngIf="!detailsData || !detailsData.antiFraudAutomaticChecks"></pe-loading-spinner>
    </div>

    <div class="paragraph">
        <pe-indent [mTop]="4"></pe-indent>
        Ручные проверки
        <pe-indent [mBottom]="4"></pe-indent>
    </div>

    <div class="manual-checks">
        <p-table
            *ngIf="!!detailsData && !!detailsData.antiFraudManualChecks"
            [value]="detailsData.antiFraudManualChecks"
            [scrollable]="true"
            [autoLayout]="true"
            [resizableColumns]="true"
            [showCurrentPageReport]="true"
            [lazy]="true"
            [columnResizeMode]="'expand'"
            styleClass="p-datatable-gridlines p-datatable-sm">
            <ng-template pTemplate="header">
                <tr>
                    <th>
                        Тип проверки
                    </th>
                    <th>
                        Статус
                    </th>
                    <th>
                        Логин пользователя
                    </th>
                    <th>
                        Дата начала рассмотрения
                    </th>
                    <th>
                        Дата окончания рассмотрения
                    </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-detailsItem>
                <tr style="min-height: 40px;">
                    <td>
                        {{detailsItem.type}}
                    </td>
                    <td>
                        {{detailsItem.status}}
                    </td>
                    <td>
                        {{detailsItem.login}}
                    </td>
                    <td>
                        {{detailsItem.startData}}
                    </td>
                    <td>
                        {{detailsItem.endData}}
                    </td>
                </tr>
            </ng-template>
        </p-table>
        <pe-loading-spinner *ngIf="!detailsData || !detailsData.antiFraudManualChecks"></pe-loading-spinner>
    </div>

    <pe-indent [mTop]="4" [mBottom]="4"></pe-indent>

    <div class="buttons">
        <p-button 
            class="bottom-button-approve mr-5"
            label="Подтвердить заявку"
            icon="pi pi-check"
            iconPos="right"
            styleClass="p-button-success">
        </p-button>
        <p-button
            class="bottom-button-cancel"
            label="Отклонить заявку"
            icon="pi pi-times"
            iconPos="right"
            styleClass="p-button-secondary">
        </p-button>
    </div>

    <pe-indent [mTop]="3"></pe-indent>

</div>
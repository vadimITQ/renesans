<div class="anti-fraud-details-header">
  <pe-indent [mTop]="4"></pe-indent>
  <pe-back-arrow (listenBack)="back()"></pe-back-arrow>
  <pe-indent [mBottom]="3"></pe-indent>
</div>

<div class="anti-fraud-details pe-border" *ngIf="hasAccessToComponent">
  <h5>AntiFraud проверка: просмотр деталей по заявке</h5>

  <div class="paragraph">
    <pe-indent [mTop]="3"></pe-indent>
    Информация по заявке
    <pe-indent [mBottom]="6"></pe-indent>
  </div>

  <div class="info-block" *ngIf="!loading; else elseBlock">
    <pe-input [labelStyle]="labelsStyle" [disabled]="true" [value]="antiFraudDetails.paymentID" label="ID PE"></pe-input>
    <pe-input [labelStyle]="labelsStyle" [disabled]="true" [value]="antiFraudDetails.pmtCreationTime" label="Дата заявки PE"></pe-input>
    <pe-input [labelStyle]="labelsStyle" [disabled]="true" [value]="antiFraudDetails.payerName" label="ФИО плательщика"></pe-input>
    <pe-input [labelStyle]="labelsStyle" [disabled]="true" [value]="antiFraudDetails.payerAccount" label="Счёт списания"></pe-input>
    <pe-input [labelStyle]="labelsStyle" [disabled]="true" [value]="antiFraudDetails.payeeName" label="ФИО получателя/наименования организации"></pe-input>
    <pe-input [labelStyle]="labelsStyle" [disabled]="true" [value]="antiFraudDetails.payeeAccount" label="Счёт получателя"></pe-input>
    <pe-input [labelStyle]="labelsStyle" [disabled]="true" [value]="antiFraudDetails.payeeINN" label="ИНН получателя"></pe-input>
    <pe-input [labelStyle]="labelsStyle" [disabled]="true" [value]="antiFraudDetails.payeeBIC" label="БИК банка получателя"></pe-input>
    <pe-input [labelStyle]="labelsStyle" [disabled]="true" [value]="antiFraudDetails.paymentPurpose" label="Назначение"></pe-input>
    <pe-input [labelStyle]="labelsStyle" [disabled]="true" [value]="antiFraudDetails.amount" label="Сумма перевода"></pe-input>
  </div>
  <ng-template #elseBlock>
    <pe-loading-spinner></pe-loading-spinner>
  </ng-template>

  <div class="paragraph">
    <pe-indent [mTop]="3"></pe-indent>
    Автоматические проверки
    <pe-indent [mBottom]="4"></pe-indent>
  </div>

  <div class="automatic-checks">
    <p-table
      *ngIf="!loading"
      [value]="antiFraudDetails.autoChecks"
      [scrollable]="true"
      [autoLayout]="true"
      [resizableColumns]="true"
      [showCurrentPageReport]="true"
      [lazy]="true"
      [columnResizeMode]="'expand'"
      styleClass="p-datatable-gridlines p-datatable-sm"
    >
      <ng-template pTemplate="header">
        <tr>
          <th>Статус автоматических проверок AntiFraud</th>
          <th>Сработавшие правила автоматических проверок AntiFraud</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-detailsItem>
        <tr>
          <td>
            {{ detailsItem.status }}
          </td>
          <td>
            {{ detailsItem.rules }}
          </td>
        </tr>
      </ng-template>
    </p-table>
    <pe-loading-spinner *ngIf="loading"></pe-loading-spinner>
  </div>

  <div class="paragraph">
    <pe-indent [mTop]="4"></pe-indent>
    Ручные проверки
    <pe-indent [mBottom]="4"></pe-indent>
  </div>

  <div class="manual-checks">
    <p-table
      *ngIf="!loading"
      [value]="antiFraudDetails.manualChecks"
      [scrollable]="true"
      [autoLayout]="true"
      [resizableColumns]="true"
      [showCurrentPageReport]="true"
      [lazy]="true"
      [columnResizeMode]="'expand'"
      styleClass="p-datatable-gridlines p-datatable-sm"
    >
      <ng-template pTemplate="header">
        <tr>
          <th>Тип проверки</th>
          <th>Статус</th>
          <th>Логин пользователя</th>
          <th>Дата начала рассмотрения</th>
          <th>Дата окончания рассмотрения</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-detailsItem>
        <tr style="min-height: 40px">
          <td>
            {{ detailsItem.checkType }}
          </td>
          <td>
            {{ detailsItem.status }}
          </td>
          <td>
            {{ detailsItem.userLogin }}
          </td>
          <td>
            {{ detailsItem.startDate }}
          </td>
          <td>
            {{ detailsItem.endDate }}
          </td>
        </tr>
      </ng-template>
    </p-table>
    <pe-loading-spinner *ngIf="loading"></pe-loading-spinner>
  </div>

  <pe-indent [mTop]="4" [mBottom]="4"></pe-indent>

  <div class="buttons">
    <p-button
      (click)="approve()"
            class="bottom-button-approve mr-5"
            label="Подтвердить заявку"
            icon="pi pi-check"
            iconPos="right"
            styleClass="p-button-success"
    >    </p-button>
        <p-button
            (click)="cancel()"
            class="bottom-button-cancel"
            label="Отклонить заявку"
            icon="pi pi-times"
            iconPos="right"
            styleClass="p-button-secondary">
        </p-button>
    </div>

  <pe-indent [mTop]="3"></pe-indent>
</div>
